GPC.url.saveUrl=GLOBAL.S.URL+GLOBAL.P.MODULES+"/a/saveFile/"+GLOBAL.P.CLASSNAME+"?_key="+GLOBAL.P.TREEONENAME+".id",GPW.form.init=function(e,r){var t=$("<div id='fileDiv'><form id='realForm' method='POST' enctype='multipart/form-data'><div id='dhxForm'></div></form></div>");$(document.body.firstChild).before(t),this.mainForm=new dhtmlXForm("dhxForm",this.getMainFormData()),e.attachObject("fileDiv"),r==GPC.constant.edit&&this.updateMainFromData(),this.mainForm.attachEvent("onValidateError",function(e,r){parent.dhtmlx.message({type:"error",expire:-1,text:"校验错误："+GPW.form.mainForm.getItemLabel(e)+"字段值不能为["+r+"]！"})});var a={type:"file",label:"选择文件",name:"file"};GPW.form.mainForm.addItem("id",a,1),this.mainForm.attachEvent("onButtonClick",function(e){function r(e){GPW.window.handle.unload(),GLOBAL.errorMessage(e),GPW.grid.refreshMainGrid()}if("save"==e){var t=GPW.tree.mainTree,a=t.getSelectedItemId();if(!a)return void alert("请选择树节点！");$("#realForm").attr("action",GPC.url.saveUrl+"&_value="+a),$("#realForm").ajaxForm({dataType:"json",error:function(e){alert(e.responseText)},success:r}),$("#realForm").submit()}})};