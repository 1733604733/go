$(window).resize(function(){GPW.layout.mainLayout.setSizes()});var GPC={url:{refreshGridUrl:GLOBAL.S.URL+GLOBAL.P.MODULES+"/a/roleLoadUser?_value="+GLOBAL.P.value,queryUrl:GLOBAL.S.URL+GLOBAL.P.MODULES+"/a/roleQueryUser?_value="+GLOBAL.P.value,updateUrl:GLOBAL.S.URL+GLOBAL.P.MODULES+"/a/updateRoleUser/Users?format=xml&_value="+GLOBAL.P.value},constant:{add:"add",edit:"edit",delect:"delect",query:"query",update:"update",detailQuery:"detailQuery",between:"between"}},GPW={layout:{},toolbar:{},grid:{}};GPW.layout={mainLayout:{},mainGridLayout:{},init:function(){this.mainLayout=new dhtmlXLayoutObject("layoutObj","1C"),this.mainGridLayout=this.mainLayout.cells("a"),this.mainGridLayout.hideHeader()}},GPW.grid={mainGrid:{},gridDataProcessor:{},init:function(){this.mainGrid=GPW.layout.mainGridLayout.attachGrid(),this.mainGrid.setImagePath(GLOBAL.IconsPath),this.mainGrid.setHeader("编码,名称,授权"),this.mainGrid.setColumnIds("name,alias,accredit"),this.mainGrid.setInitWidths("100,100,100"),this.mainGrid.setColAlign("left,left,left"),this.mainGrid.setColTypes("ro,ro,acheck"),this.mainGrid.setColSorting("str,str,str"),GLOBAL.initGridCombo(this.mainGrid,{accredit:[{text:"是",value:"1"},{text:"否",value:"0"}]});var a="<div id='recinfoArea' /><div id='pagingArea' style='border:none;'/>",t=GPW.layout.mainGridLayout.attachStatusBar({height:28});t.setText(a),this.mainGrid.enablePaging(!0,20,5,"pagingArea",!0,"recInfoArea"),this.mainGrid.setPagingSkin("toolbar","dhx_skyblue"),this.mainGrid.i18n.paging=GLOBAL.paging,this.mainGrid.init(),this.mainGrid.attachEvent("onValidationError",function(a,t,e,i){parent.dhtmlx.message({type:"error",expire:-1,text:"校验错误："+GPW.grid.mainGrid.getColLabel(t)+","+GLOBAL.validText(i)+",字段值不能为["+e+"]！"})}),this.gridDataProcessor=new dataProcessor(GPC.url.updateUrl),this.gridDataProcessor.setTransactionMode("REST"),this.gridDataProcessor.setUpdateMode("off"),this.gridDataProcessor.enableDataNames(!0),this.gridDataProcessor.enablePartialDataSend(!0),this.gridDataProcessor.init(this.mainGrid),this.gridDataProcessor.attachEvent("onBeforeDataSending",function(a,t,e){return _.each(e,function(a){a.data&&(a.data=null,delete a.data)}),!0}),this.gridDataProcessor.attachEvent("onAfterUpdate",function(a,t,e,i){if(i instanceof Element&&null!=i.getElementsByTagName("code").item(0)){var r=i.getElementsByTagName("code").item(0).childNodes[0].nodeValue,n=i.getElementsByTagName("message").item(0).childNodes[0].nodeValue;-1==r&&parent.dhtmlx.message({type:"error",expire:-1,text:n})}}),this.refreshMainGrid()},sendGridData:function(){this.gridDataProcessor.sendData()},refreshMainGrid:function(a){a||(a=GPC.url.refreshGridUrl),this.mainGrid.clearAll(),this.mainGrid.load(a,"js")}},GPW.toolbar={mainToolbar:{},init:function(){this.mainToolbar=GPW.layout.mainGridLayout.attachToolbar();var a=this.mainToolbar;a.setIconsPath(GLOBAL.IconsPath),a.addText("text_select",0,"选"),this.mainToolbar.addSelectEx("queryName",1,[{text:"编码",value:"name"},{text:"名称",value:"alias"}],100),a.addInput("queryValue",3,"",200),a.addButton("query",9,"查询","new.gif","new_dis.gif"),a.addSeparator("sep1",10),a.addButton("update",16,"更新","new.gif","new_dis.gif"),this.mainToolbarClick()},mainToolbarClick:function(){this.mainToolbar.attachEvent("onClick",function(a){switch(a){case GPC.constant.query:var t=GPW.toolbar.mainToolbar,e=t.getInput("queryName").value,i=t.getInput("queryValue").value,r=GPC.url.queryUrl+"&where="+encodeURI(e)+"&whereValue="+encodeURI(i);GPW.grid.refreshMainGrid(r);break;case GPC.constant.update:GPW.grid.sendGridData()}})}},$(function(){GPW.layout.init(),GPW.grid.init(),GPW.toolbar.init()});