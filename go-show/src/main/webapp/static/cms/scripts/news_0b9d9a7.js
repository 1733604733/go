$(window).resize(function(){GPW.layout.treeLayout.setWidth(200),GPW.layout.mainLayout.setSizes()});var GPC={url:{treeQueryUrl:GLOBAL.S.URL+GLOBAL.P.MODULES+"/loadTree",publishInfoUrl:GLOBAL.S.URL+GLOBAL.P.MODULES+"/publishInfo",loadActiveTabUrl:GLOBAL.S.URL+GLOBAL.P.MODULES+"/container"},constant:{add:"add",edit:"edit",delect:"delect",query:"query",select:"select",update:"update",detailQuery:"detailQuery",between:"between"}},GPW={layout:{},toolbar:{},tree:{},grid:{},window:{},form:{},paging:{},cache:{},tabbar:{}};GPW.cache={grid:{},recodeId:null},GPW.layout={mainLayout:{},mainGridLayout:{},treeLayout:{},init:function(){this.mainLayout=new dhtmlXLayoutObject("layoutObj","2U"),this.treeLayout=this.mainLayout.cells("a"),this.treeLayout.setWidth(200),this.treeLayout.hideHeader(),this.tabbarLayout=this.mainLayout.cells("b"),this.tabbarLayout.setHeight(300),this.tabbarLayout.hideHeader()}},GPW.tree={mainTree:{},init:function(){this.mainTree=GPW.layout.treeLayout.attachTree(),this.mainTree.setImagePath(GLOBAL.IconsPath+"dhxtree_skyblue/"),this.mainTree.enableTreeImages("false"),this.mainTree.setXMLAutoLoading(GPC.url.treeQueryUrl),this.mainTree.setDataMode("json"),this.mainTree.loadJSON(GPC.url.treeQueryUrl),this.onClick()},onClick:function(){this.mainTree.attachEvent("onClick",function(t){return this.hasChildren(t)||GPW.tabbar.loadActiveTab(),!0})}},GPW.tabbar={subListTabbar:{},subInfo:[{name:"publish",alias:"发布箱",oneName:"tpl"},{name:"pendingtrial",alias:"待审箱",oneName:"tpl"},{name:"rubbish",alias:"垃圾箱",oneName:"tpl"},{name:"publishInfo",alias:"发布信息",oneName:"tpl"}],getTabs:function(){for(var t=GPW.tabbar.subInfo,e=new Array(t.length),a=0;a<t.length;a++){var i={};i.id=t[a].name,i.text=t[a].alias,0==a&&(i.active=!0),e[a]=i}return e},attachURL:function(t){{var e,a=GPW.tabbar.subInfo;_.find(a,function(e){return e.name==t?e:void 0})}if("publishInfo"==t)e=GPC.url.publishInfoUrl,null!=GPW.cache.recodeId&&(e+="?id="+GPW.cache.recodeId,GPW.cache.recodeId=null);else{var i=GPW.tree.mainTree.getSelectedItemId();if(null==i||""==i)return;e=GPC.url.loadActiveTabUrl+"?_pid="+i+"&_type="+t}this.subListTabbar.tabs(t).attachURL(e)},initSubList:function(){this.subListTabbar=GPW.layout.tabbarLayout.attachTabbar({tabs:GPW.tabbar.getTabs()}),this.subListTabbar.attachEvent("onSelect",function(t){var e=GPW.tree.mainTree.getSelectedItemId();return null==e||""==e?(dhtmlx.alert("请选择分类节点！"),!1):(GPW.tabbar.attachURL(t),!0)})},loadActiveTab:function(){var t=this.subListTabbar.getActiveTab();this.attachURL(t)}},GPW.window={handle:{},subWindow:{},initHandle:function(){return this.handle=new dhtmlXWindows,this.handle},initSubWindow:function(t,e){return this.initHandle(),this.handle.attachViewportTo("layoutObj"),this.subWindow=this.handle.createWindow("w1",$("#layoutObj").width()/2-t/2,30,t,e),this.subWindow}},$(function(){GPW.layout.init(),GPW.tree.init(),GPW.tabbar.initSubList()});